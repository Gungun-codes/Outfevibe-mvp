{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 10, "column": 0}, "map": {"version":3,"sources":["file:///D:/Colledge%20study/Outfevibe-mvp-main/Outfevibe-mvp-main/src/lib/supabase.ts"],"sourcesContent":["import { createClient } from '@supabase/supabase-js';\n\nconst supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL!;\nconst supabaseAnonKey = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!;\n\nexport const supabase = createClient(supabaseUrl, supabaseAnonKey);\n"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM;AACN,MAAM;AAEC,MAAM,WAAW,IAAA,8LAAY,EAAC,aAAa"}},
    {"offset": {"line": 23, "column": 0}, "map": {"version":3,"sources":["file:///D:/Colledge%20study/Outfevibe-mvp-main/Outfevibe-mvp-main/src/context/authContext.tsx"],"sourcesContent":["\"use client\";\n\nimport React, { createContext, useState, useEffect, useContext } from \"react\";\nimport { supabase } from \"@/lib/supabase\";\nimport type { User, Session } from \"@supabase/supabase-js\";\n\ninterface AuthContextType {\n    user: User | null;\n    session: Session | null;\n    loading: boolean;\n    login: (email: string, password: string) => Promise<void>;\n    signup: (email: string, password: string, displayName: string) => Promise<void>;\n    loginWithGoogle: () => Promise<void>;\n    logout: () => Promise<void>;\n}\n\nconst AuthContext = createContext<AuthContextType | undefined>(undefined);\n\nexport const AuthProvider = ({ children }: { children: React.ReactNode }) => {\n    const [user, setUser] = useState<User | null>(null);\n    const [session, setSession] = useState<Session | null>(null);\n    const [loading, setLoading] = useState(true);\n\n    useEffect(() => {\n        // Get initial session\n        supabase.auth.getSession().then(({ data: { session } }) => {\n            setSession(session);\n            setUser(session?.user ?? null);\n            setLoading(false);\n        });\n\n        // Listen for auth changes\n        const {\n            data: { subscription },\n        } = supabase.auth.onAuthStateChange(async (event, session) => {\n            setSession(session);\n            setUser(session?.user ?? null);\n            setLoading(false);\n\n            // Save/update user profile on sign in (catches Google OAuth + email logins)\n            if (event === \"SIGNED_IN\" && session?.user) {\n                const u = session.user;\n                const fullName =\n                    u.user_metadata?.full_name ||\n                    u.user_metadata?.display_name ||\n                    u.user_metadata?.name ||\n                    u.email?.split(\"@\")[0] ||\n                    \"\";\n\n                const { error } = await supabase\n                    .from(\"users_profile\")\n                    .upsert(\n                        {\n                            id: u.id,\n                            full_name: fullName,\n                            email: u.email || \"\",\n                        },\n                        { onConflict: \"id\" }\n                    );\n                if (error) console.error(\"Error saving user profile:\", error);\n            }\n        });\n\n        return () => subscription.unsubscribe();\n    }, []);\n\n    const login = async (email: string, password: string) => {\n        const { error } = await supabase.auth.signInWithPassword({\n            email,\n            password,\n        });\n        if (error) throw error;\n    };\n\n    const signup = async (email: string, password: string, displayName: string) => {\n        const { data, error } = await supabase.auth.signUp({\n            email,\n            password,\n            options: {\n                data: {\n                    display_name: displayName,\n                },\n            },\n        });\n        if (error) throw error;\n\n        // Store user data in users_profile table (non-fatal if it fails)\n        if (data.user) {\n            try {\n                const { error: dbError } = await supabase\n                    .from(\"users_profile\")\n                    .upsert(\n                        {\n                            id: data.user.id,\n                            full_name: displayName,\n                            email: data.user.email || \"\",\n                        },\n                        { onConflict: \"id\" }\n                    );\n                if (dbError) console.error(\"Error saving user profile:\", dbError);\n            } catch (profileErr) {\n                console.error(\"Profile creation failed (non-fatal):\", profileErr);\n            }\n        }\n    };\n\n    const loginWithGoogle = async () => {\n        const { error } = await supabase.auth.signInWithOAuth({\n            provider: 'google',\n            options: {\n                redirectTo: `${window.location.origin}/`,\n            },\n        });\n        if (error) throw error;\n    };\n\n    const logout = async () => {\n        await supabase.auth.signOut();\n        // Force a hard redirect to clear all state properly\n        window.location.href = \"/\";\n    };\n\n    return (\n        <AuthContext.Provider value={{ user, session, loading, login, signup, loginWithGoogle, logout }}>\n            {children}\n        </AuthContext.Provider>\n    );\n};\n\nexport const useAuth = () => {\n    const context = useContext(AuthContext);\n    if (context === undefined) {\n        throw new Error(\"useAuth must be used within an AuthProvider\");\n    }\n    return context;\n};\n"],"names":[],"mappings":"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"}}]
}